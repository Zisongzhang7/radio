# ğŸ”§ å¿«é€Ÿä¿®å¤æŒ‡å—

## âš ï¸ é—®é¢˜è¯Šæ–­

æ‚¨çš„æ¿å­ä¸èƒ½æ­£å¸¸å·¥ä½œçš„**æ ¹æœ¬åŸå› **æ˜¯ï¼š

**å½“å‰é€‰æ‹©çš„æ¿å­ç±»å‹ä¸æ­£ç¡®ï¼**

- âŒ **å½“å‰é…ç½®**: `BREAD_COMPACT_WIFI` ï¼ˆé¢åŒ…æ¿é…ç½®ï¼‰
- âœ… **åº”è¯¥é€‰æ‹©**: `ESP32S3_DEVKITC_CUSTOM` ï¼ˆæ‚¨çš„è‡ªå®šä¹‰ç¡¬ä»¶ï¼‰

è¿™æ„å‘³ç€ï¼š
- GPIO å¼•è„šé…ç½®é”™è¯¯ï¼ˆåŠŸæ”¾å’Œéº¦å…‹é£çš„å¼•è„šä¸åŒ¹é…ï¼‰
- å¯èƒ½ä½¿ç”¨äº†é”™è¯¯çš„éŸ³é¢‘ç¼–è§£ç å™¨é…ç½®
- æŒ‰é”®åŠŸèƒ½ä¸æ­£ç¡®

---

## ğŸš€ è§£å†³æ–¹æ¡ˆï¼ˆä¸‰æ­¥èµ°ï¼‰

### æ­¥éª¤ 1: åˆå§‹åŒ– ESP-IDF ç¯å¢ƒ

æ‰“å¼€ç»ˆç«¯ï¼Œè¿è¡Œï¼š

```bash
# æ ¹æ®æ‚¨çš„ ESP-IDF å®‰è£…ä½ç½®è°ƒæ•´è·¯å¾„
source ~/esp/esp-idf/export.sh

# æˆ–è€…
source ~/.espressif/esp-idf/export.sh
```

éªŒè¯ç¯å¢ƒï¼š
```bash
idf.py --version
# åº”è¯¥æ˜¾ç¤º ESP-IDF ç‰ˆæœ¬ä¿¡æ¯ï¼ˆéœ€è¦ 5.4 æˆ–æ›´é«˜ï¼‰
```

### æ­¥éª¤ 2: è‡ªåŠ¨é…ç½®æ‚¨çš„æ¿å­

```bash
cd /Users/zhangzisong/Desktop/test1.1/xiaozhi-esp32-main
./setup_custom_board.sh
```

è¿™ä¸ªè„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- âœ… è®¾ç½®ç›®æ ‡ä¸º ESP32-S3
- âœ… é€‰æ‹©æ‚¨çš„è‡ªå®šä¹‰æ¿å­ç±»å‹
- âœ… é…ç½®æ­£ç¡®çš„ GPIO å¼•è„š
- âœ… ä½¿ç”¨ 16MB Flash åˆ†åŒºè¡¨

### æ­¥éª¤ 3: ç¼–è¯‘å¹¶çƒ§å½•

```bash
# ç¼–è¯‘å›ºä»¶
idf.py build

# æŸ¥æ‰¾ä¸²å£è®¾å¤‡
ls /dev/cu.* | grep usb
# ä¼šæ˜¾ç¤ºç±»ä¼¼ï¼š/dev/cu.usbserial-14420

# çƒ§å½•å¹¶æŸ¥çœ‹æ—¥å¿—ï¼ˆæ›¿æ¢ PORT ä¸ºä¸Šé¢æ‰¾åˆ°çš„è®¾å¤‡ï¼‰
idf.py -p /dev/cu.usbserial-14420 flash monitor
```

---

## ğŸ¯ ä¸€é”®å‘½ä»¤ï¼ˆå¤åˆ¶ç²˜è´´ï¼‰

å¦‚æœæ‚¨ç¡®å®š ESP-IDF å·²å®‰è£…åœ¨ `~/esp/esp-idf`ï¼š

```bash
# ä¸€é”®æ‰§è¡Œæ‰€æœ‰æ­¥éª¤
cd /Users/zhangzisong/Desktop/test1.1/xiaozhi-esp32-main && \
source ~/esp/esp-idf/export.sh && \
./setup_custom_board.sh && \
idf.py build
```

ç„¶åçƒ§å½•ï¼ˆæ›¿æ¢ä¸²å£å·ï¼‰ï¼š
```bash
idf.py -p /dev/cu.usbserial-XXXX flash monitor
```

---

## ğŸ“‹ é…ç½®å‰åå¯¹æ¯”

### âŒ é”™è¯¯é…ç½®ï¼ˆå½“å‰ï¼‰

```
æ¿å­ç±»å‹: BREAD_COMPACT_WIFI
éº¦å…‹é£å¼•è„š: WS=4, SCK=5, DIN=6  â† è¿™äº›å¯èƒ½æ˜¯å¯¹çš„
åŠŸæ”¾å¼•è„š: DOUT=7, BCLK=15, LRCK=16  â† ä½†ç¼–è§£ç å™¨é…ç½®æ˜¯é”™çš„
éŸ³é¢‘ç¼–è§£ç å™¨: é¢åŒ…æ¿é»˜è®¤é…ç½®ï¼ˆä¸é€‚åˆæ‚¨çš„ç¡¬ä»¶ï¼‰
```

### âœ… æ­£ç¡®é…ç½®ï¼ˆä¿®å¤åï¼‰

```
æ¿å­ç±»å‹: ESP32S3_DEVKITC_CUSTOM
éº¦å…‹é£å¼•è„š: WS=4, SCK=5, SD=6
åŠŸæ”¾å¼•è„š: DIN=7, BCLK=15, LRC=16
éŸ³é¢‘ç¼–è§£ç å™¨: NoAudioCodec Simplexï¼ˆä¸“ä¸ºæ•°å­—éº¦å…‹é£å’ŒåŠŸæ”¾è®¾è®¡ï¼‰
æŒ‰é”®: GPIO 0, 40, 39
æ˜¾ç¤º: NoDisplayï¼ˆæ— å±å¹•ï¼‰
```

---

## ğŸ” éªŒè¯é…ç½®æˆåŠŸ

è¿è¡Œä»¥ä¸‹å‘½ä»¤ç¡®è®¤é…ç½®æ­£ç¡®ï¼š

```bash
./verify_custom_board.sh
```

åº”è¯¥çœ‹åˆ°ï¼š
```
âœ… æ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼
```

æ£€æŸ¥ç¼–è¯‘é…ç½®ï¼š
```bash
grep "CONFIG_BOARD_TYPE.*=y" sdkconfig
```

åº”è¯¥æ˜¾ç¤ºï¼š
```
CONFIG_BOARD_TYPE_ESP32S3_DEVKITC_CUSTOM=y
```

---

## ğŸ“Š é¢„æœŸç»“æœ

é…ç½®ä¿®å¤åï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ï¼š

### 1. ç¼–è¯‘æˆåŠŸ
```
Project build complete. To flash, run:
idf.py -p PORT flash
```

### 2. çƒ§å½•æˆåŠŸ
```
Hash of data verified.

Leaving...
Hard resetting via RTS pin...
```

### 3. è®¾å¤‡å¯åŠ¨æ—¥å¿—
```
I (xxx) ESP32S3DevKitCCustom: Initializing ESP32-S3-DevKitC-1 Custom Board
I (xxx) Audio: Initializing audio codec (Simplex mode)
I (xxx) Audio: Microphone initialized
I (xxx) Audio: Speaker initialized
I (xxx) WiFi: Starting WiFi configuration...
```

---

## âš¡ å¿«é€Ÿæµ‹è¯•

çƒ§å½•æˆåŠŸåï¼Œæµ‹è¯•ç¡¬ä»¶ï¼š

1. **æµ‹è¯•æŒ‰é”®**
   - çŸ­æŒ‰ BOOT æŒ‰é’®ï¼ˆGPIO 0ï¼‰â†’ åº”è¯¥åˆ‡æ¢èŠå¤©çŠ¶æ€
   - çŸ­æŒ‰éŸ³é‡+ï¼ˆGPIO 40ï¼‰â†’ éŸ³é‡å¢åŠ 
   - çŸ­æŒ‰éŸ³é‡-ï¼ˆGPIO 39ï¼‰â†’ éŸ³é‡å‡å°

2. **æµ‹è¯•éŸ³é¢‘è¾“å‡º**
   - è®¾å¤‡åº”è¯¥æ’­æ”¾å¼€æœºæç¤ºéŸ³
   - åœ¨ä¸²å£æ—¥å¿—ä¸­æŸ¥æ‰¾éŸ³é¢‘ç›¸å…³ä¿¡æ¯

3. **æµ‹è¯•éº¦å…‹é£**
   - è¯´å”¤é†’è¯ "ä½ å¥½å°æ™º"
   - è§‚å¯Ÿä¸²å£æ—¥å¿—æ˜¯å¦æ£€æµ‹åˆ°è¯­éŸ³

---

## ğŸ†˜ å¦‚æœè¿˜æ˜¯ä¸å·¥ä½œ

è¯·æŒ‰ä»¥ä¸‹é¡ºåºæ£€æŸ¥ï¼š

1. **ç¡¬ä»¶è¿æ¥** â†’ å‚è€ƒ [README.md](main/boards/esp32s3-devkitc-custom/README.md)
2. **ä¾›ç”µé—®é¢˜** â†’ ä½¿ç”¨è‡³å°‘ 500mA çš„ USB ç”µæº
3. **ä¸²å£æ—¥å¿—** â†’ æŸ¥çœ‹ `idf.py monitor` çš„å®Œæ•´è¾“å‡º
4. **è¯¦ç»†æ’æŸ¥** â†’ æŸ¥çœ‹ [TROUBLESHOOTING.md](TROUBLESHOOTING.md)

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

æä¾›ä»¥ä¸‹ä¿¡æ¯å¯ä»¥æ›´å¿«è·å¾—å¸®åŠ©ï¼š

```bash
# 1. æ£€æŸ¥é…ç½®
grep "CONFIG_BOARD_TYPE.*=y" sdkconfig

# 2. ESP-IDF ç‰ˆæœ¬
idf.py --version

# 3. ä¿å­˜å®Œæ•´æ—¥å¿—
idf.py -p PORT monitor > debug.log 2>&1
```

ç„¶ååœ¨è¿™é‡Œå¯»æ±‚å¸®åŠ©ï¼š
- GitHub: https://github.com/78/xiaozhi-esp32/issues
- QQ ç¾¤: 1011329060

---

**è®°ä½**: æœ€å…³é”®çš„æ˜¯ç¡®ä¿é€‰æ‹©äº†æ­£ç¡®çš„æ¿å­ç±»å‹ï¼

