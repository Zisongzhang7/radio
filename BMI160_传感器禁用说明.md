# BMI160 传感器已禁用

## 问题原因

您的板子类型是 **bread-compact-wifi**，该板子已经使用了I2C总线进行显示器初始化。我们添加的BMI160传感器使用的I2C引脚（GPIO9和GPIO8）与板子原有的I2C配置发生了冲突，导致系统崩溃。

## 错误信息

```
CompactWifiBoard::InitializeDisplay2C() 崩溃
原因：I2C总线冲突
```

## 已执行的修复

为了让系统正常运行，我已经禁用了BMI160传感器监控功能：

### 1. 修改的文件

**main/main.cc**
- 注释掉了 `#include "sensor_manager.h"`
- 注释掉了传感器初始化代码

**main/CMakeLists.txt**
- 注释掉了 `sensor_manager.cc` 的编译

### 2. 当前状态

✅ 系统可以正常启动
✅ 原有功能不受影响
❌ BMI160传感器监控已禁用

## 如何重新启用传感器

如果您确实需要使用BMI160传感器，需要先解决I2C冲突问题：

### 选项1：查找板子的I2C配置

1. 查看您的板子配置文件：
   ```bash
   cat main/boards/bread-compact-wifi/compact_wifi_board.cc
   ```

2. 找到板子使用的I2C引脚，避开这些引脚

3. 修改 `main/sensor_manager.cc` 中的I2C配置：
   ```cpp
   #define I2C_SCL_IO      GPIO_NUM_XX  // 改为不冲突的引脚
   #define I2C_SDA_IO      GPIO_NUM_XX  // 改为不冲突的引脚
   ```

### 选项2：使用不同的I2C端口

如果ESP32有多个I2C端口可用，可以修改：
```cpp
i2c_master_bus_config_t i2c_bus_config = {
    .i2c_port = I2C_NUM_1,  // 改用I2C_NUM_1而不是I2C_NUM_0
    ...
};
```

### 选项3：检查BMI160接线

确认您的BMI160模块实际连接的引脚是否与代码中配置的一致，并且不与板子原有功能冲突。

## 重新启用步骤

确认I2C引脚配置无冲突后：

1. **修改 main/main.cc**
   ```cpp
   // 取消注释
   #include "sensor_manager.h"
   
   // 取消注释传感器初始化代码
   auto& sensor_manager = SensorManager::GetInstance();
   if (sensor_manager.Initialize()) {
       ESP_LOGI(TAG, "传感器系统初始化成功");
       sensor_manager.Start();
   } else {
       ESP_LOGW(TAG, "传感器系统初始化失败，继续启动应用程序");
   }
   ```

2. **修改 main/CMakeLists.txt**
   ```cmake
   "sensor_manager.cc"  # 取消注释
   ```

3. **重新编译**
   ```bash
   idf.py fullclean
   idf.py build
   idf.py flash
   ```

## 建议的GPIO引脚

对于bread-compact-wifi板，建议使用以下未使用的GPIO：
- GPIO16、GPIO17（如果未被占用）
- GPIO18、GPIO19（如果未被占用）
- GPIO25、GPIO26（如果未被占用）

**注意**：使用前请务必确认这些引脚在您的板子上未被其他功能占用。

## 查看板子配置

运行以下命令查看您的板子详细配置：
```bash
cat main/boards/bread-compact-wifi/compact_wifi_board.cc
cat main/boards/bread-compact-wifi/compact_wifi_board.h
```

## 保留的文件

传感器相关的代码文件仍然保留在项目中，只是未编译：
- `main/sensor_manager.h`
- `main/sensor_manager.cc`
- `main/boards/common/bmi160.h`
- `main/boards/common/bmi160.cc`

如需完全删除，可以运行：
```bash
rm main/sensor_manager.*
rm main/boards/common/bmi160.*
```

## 技术支持

如需帮助确定正确的GPIO配置，请提供：
1. 您的板子原理图
2. BMI160模块实际连接的引脚
3. 板子配置文件内容

---

**当前状态**：传感器监控已禁用，系统应能正常运行。

